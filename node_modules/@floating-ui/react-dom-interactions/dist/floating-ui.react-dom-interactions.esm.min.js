import{useFloating as e,getOverflowAncestors as n}from"@floating-ui/react-dom";export*from"@floating-ui/react-dom";import*as t from"react";import{useLayoutEffect as r,useEffect as o,useRef as u}from"react";import{createPortal as c}from"react-dom";import{hideOthers as i}from"aria-hidden";var l="undefined"!=typeof document?r:o;function a(){const e=new Map;return{emit(n,t){var r;null==(r=e.get(n))||r.forEach((e=>e(t)))},on(n,t){e.set(n,[...e.get(n)||[],t])},off(n,t){e.set(n,(e.get(n)||[]).filter((e=>e!==t)))}}}let s=!1,f=0;const d=()=>"floating-ui-"+f++;const v=t["useId".toString()],m=null!=v?v:function(){const[e,n]=t.useState((()=>s?d():void 0));return l((()=>{null==e&&n(d())}),[]),t.useEffect((()=>{s||(s=!0)}),[]),e},p=t.createContext(null),g=t.createContext(null),b=()=>{var e,n;return null!=(e=null==(n=t.useContext(p))?void 0:n.id)?e:null},y=()=>t.useContext(g),h=()=>{const e=m(),n=y(),t=b();return l((()=>{const r={id:e,parentId:t};return null==n||n.addNode(r),()=>{null==n||n.removeNode(r)}}),[n,e,t]),e},E=e=>{let{children:n,id:r}=e;const o=b();return t.createElement(p.Provider,{value:t.useMemo((()=>({id:r,parentId:o})),[r,o])},n)},w=e=>{let{children:n}=e;const r=t.useRef([]),o=t.useCallback((e=>{r.current=[...r.current,e]}),[]),u=t.useCallback((e=>{r.current=r.current.filter((n=>n!==e))}),[]),c=t.useState((()=>a()))[0];return t.createElement(g.Provider,{value:t.useMemo((()=>({nodesRef:r,addNode:o,removeNode:u,events:c})),[r,o,u,c])},n)};function x(n){let{open:r=!1,onOpenChange:o=(()=>{}),whileElementsMounted:u,placement:c,middleware:i,strategy:s,nodeId:f}=void 0===n?{}:n;const d=y(),v=t.useRef({}),m=t.useState((()=>a()))[0],p=e({placement:c,middleware:i,strategy:s,whileElementsMounted:u}),g=t.useMemo((()=>({...p,dataRef:v,nodeId:f,events:m,open:r,onOpenChange:o})),[p,v,f,m,r,o]);return l((()=>{const e=null==d?void 0:d.nodesRef.current.find((e=>e.id===f));e&&(e.context=g)})),t.useMemo((()=>({context:g,...p})),[p,g])}function R(e,n,t){const r={};return{..."floating"===t&&{tabIndex:-1},...e,...n.map((e=>e?e[t]:null)).concat(e).reduce(((e,n)=>n?(Object.entries(n).forEach((n=>{let[t,o]=n;0===t.indexOf("on")?(r[t]||(r[t]=[]),"function"==typeof o&&r[t].push(o),e[t]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];r[t].forEach((e=>e(...n)))}):e[t]=o})),e):e),{})}}const L=function(e){return void 0===e&&(e=[]),{getReferenceProps:n=>R(n,e,"reference"),getFloatingProps:n=>R(n,e,"floating"),getItemProps:n=>R(n,e,"item")}};function k(e){var n;return null!=(n=null==e?void 0:e.ownerDocument)?n:document}function I(e){var n;return null!=(n=k(e).defaultView)?n:window}function T(e){return!!e&&e instanceof I(e).Element}function C(e){return!!e&&e instanceof I(e).HTMLElement}function A(e,n){var t;let r=null!=(t=e.filter((e=>{var t;return e.parentId===n&&(null==(t=e.context)?void 0:t.open)})))?t:[],o=r;for(;o.length;){var u;o=null!=(u=e.filter((e=>{var n;return null==(n=o)?void 0:n.some((n=>{var t;return e.parentId===n.id&&(null==(t=e.context)?void 0:t.open)}))})))?u:[],r=r.concat(o)}return r}function O(e){let n,{restMs:t=0,buffer:r=.5,debug:o=null}=void 0===e?{}:e,u=!1;return e=>{let{x:o,y:c,placement:i,refs:l,onClose:a,nodeId:s,tree:f,leave:d=!1}=e;return function(e){var v;function m(){clearTimeout(n),a()}if(clearTimeout(n),e.pointerType&&"mouse"!==e.pointerType)return;const{clientX:p,clientY:g}=e,b="composedPath"in e?e.composedPath()[0]:e.target;if("pointermove"===e.type&&T(l.reference.current)&&l.reference.current.contains(b))return;if(f&&A(f.nodesRef.current,s).some((e=>{let{context:n}=e;return null==n?void 0:n.open})))return;if(null!=(v=l.floating.current)&&v.contains(b)&&!d)return void(u=!0);if(!l.reference.current||!l.floating.current||null==i||null==o||null==c)return;const y=l.reference.current.getBoundingClientRect(),h=l.floating.current.getBoundingClientRect(),E=i.split("-")[0],w=o>h.right-h.width/2,x=c>h.bottom-h.height/2;if("top"===E&&c>=y.bottom-1||"bottom"===E&&c<=y.top+1||"left"===E&&o>=y.right-1||"right"===E&&o<=y.left+1)return m();switch(E){case"top":if(p>=h.left&&p<=h.right&&g>=h.top&&g<=y.top+1)return;break;case"bottom":if(p>=h.left&&p<=h.right&&g>=y.bottom-1&&g<=h.bottom)return;break;case"left":if(p>=h.left&&p<=y.left+1&&g>=h.top&&g<=h.bottom)return;break;case"right":if(p>=y.right-1&&p<=h.right&&g>=h.top&&g<=h.bottom)return}if(u)return m();const R=function(e){let[n,t]=e;const o=h.width>y.width,u=h.height>y.height;switch(E){case"top":return[[o?n+r/2:w?n+4*r:n-4*r,t+r+1],[o?n-r/2:w?n+4*r:n-4*r,t+r+1],...[[h.left,w||o?h.bottom-r:h.top],[h.right,w?o?h.bottom-r:h.top:h.bottom-r]]];case"bottom":return[[o?n+r/2:w?n+4*r:n-4*r,t-r],[o?n-r/2:w?n+4*r:n-4*r,t-r],...[[h.left,w||o?h.top+r:h.bottom],[h.right,w?o?h.top+r:h.bottom:h.top+r]]];case"left":{const e=[n+r+1,u?t+r/2:x?t+4*r:t-4*r],o=[n+r+1,u?t-r/2:x?t+4*r:t-4*r];return[...[[x||u?h.right-r:h.left,h.top],[x?u?h.right-r:h.left:h.right-r,h.bottom]],e,o]}case"right":return[[n-r,u?t+r/2:x?t+4*r:t-4*r],[n-r,u?t-r/2:x?t+4*r:t-4*r],...[[x||u?h.left+r:h.right,h.top],[x?u?h.left+r:h.right:h.left+r,h.bottom]]]}}([o,c]);!function(e,n){const[t,r]=e;let o=!1;const u=n.length;for(let e=0,c=u-1;e<u;c=e++){const[u,i]=n[e]||[0,0],[l,a]=n[c]||[0,0];i>=r!=a>=r&&t<=(l-u)*(r-i)/(a-i)+u&&(o=!o)}return o}([p,g],R)?m():t&&(n=setTimeout(a,t))}}}const M="floating-ui-root",D=function(e){let{id:n=M,enabled:r=!0}=void 0===e?{}:e;const[o,u]=t.useState(null);return l((()=>{if(!r)return;const e=document.getElementById(n);if(e)u(e);else{const e=document.createElement("div");e.id=n,u(e),document.body.contains(e)||document.body.appendChild(e)}}),[n,r]),o},P=e=>{let{children:n,id:t=M,root:r=null}=e;const o=D({id:t,enabled:!r});return r?c(n,r):o?c(n,o):null};function S(){return S=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},S.apply(this,arguments)}const F="data-floating-ui-scroll-lock";const K=t.forwardRef((function(e,n){let{lockScroll:r=!1,...o}=e;return l((()=>{var e,n,t,o;if(!r)return;if(document.body.hasAttribute(F))return;document.body.setAttribute(F,"");const u=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",c=window.innerWidth-document.documentElement.clientWidth;if(!/iP(hone|ad|od)|iOS/.test(function(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}()))return Object.assign(document.body.style,{overflow:"hidden",[u]:c+"px"}),()=>{document.body.removeAttribute(F),Object.assign(document.body.style,{overflow:"",[u]:""})};const i=null!=(e=null==(n=window.visualViewport)?void 0:n.offsetLeft)?e:0,l=null!=(t=null==(o=window.visualViewport)?void 0:o.offsetTop)?t:0,a=window.pageXOffset,s=window.pageYOffset;return Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:-(s-Math.floor(l))+"px",left:-(a-Math.floor(i))+"px",right:"0",[u]:c+"px"}),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[u]:""}),document.body.removeAttribute(F),window.scrollTo(a,s)}}),[r]),t.createElement("div",S({ref:n},o,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...o.style}}))}));function j(e){let n=e.activeElement;for(;null!=(null==(t=n)||null==(r=t.shadowRoot)?void 0:r.activeElement);){var t,r;n=n.shadowRoot.activeElement}return n}const N="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function B(e){return C(e)&&e.matches(N)}function V(e){e.preventDefault(),e.stopPropagation()}function U(e){const n=u(e);return l((()=>{n.current=e})),n}function H(e){requestAnimationFrame((()=>{null==e||e.focus()}))}const X=t.forwardRef((function(e,n){return t.createElement("span",S({},e,{ref:n,tabIndex:0,style:{position:"fixed",opacity:"0",pointerEvents:"none",outline:"0"}}))}));function Y(e){let{context:{refs:n,nodeId:r,onOpenChange:o},children:u,order:c=["content"],endGuard:l=!0,preventTabbing:a=!1,initialFocus:s=0,returnFocus:f=!0,modal:d=!0}=e;const v=U(c),m=U(o),p=y(),g=t.useCallback((()=>v.current.map((e=>{return C(n.reference.current)&&"reference"===e?n.reference.current:n.floating.current&&"floating"===e?n.floating.current:"content"===e?Array.from(null!=(t=null==(r=n.floating.current)?void 0:r.querySelectorAll("select:not([disabled]),a[href],button:not([disabled]),[tabindex],iframe,object,embed,area[href],audio[controls],video[controls],input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])"))?t:[]):null;var t,r})).flat().filter((e=>{if(e===n.floating.current||e===n.reference.current)return!0;if(C(e)){var t;return"-"!==(null!=(t=e.getAttribute("tabindex"))?t:"0")[0].trim()}}))),[v,n]);t.useEffect((()=>{if(!d)return;const e=0===g().filter((e=>e!==n.floating.current&&e!==n.reference.current)).length;function t(t){if("Tab"===t.key){(a||e)&&V(t);const r=g(),o="composedPath"in t?t.composedPath()[0]:t.target;"reference"===v.current[0]&&o===n.reference.current&&(V(t),t.shiftKey?H(r[r.length-1]):H(r[1])),"floating"===v.current[1]&&o===n.floating.current&&t.shiftKey&&(V(t),H(r[0]))}}const r=k(n.floating.current);return r.addEventListener("keydown",t),()=>{r.removeEventListener("keydown",t)}}),[a,d,g,v,n]),t.useEffect((()=>{function e(e){var t,o;const u=e.relatedTarget,c=!(null!=(t=n.floating.current)&&t.contains(u)),i=T(n.reference.current)&&!n.reference.current.contains(u),l=p&&A(p.nodesRef.current,r).length>0,a=p&&e.currentTarget===n.reference.current&&(null==(o=function(e,n){var t;let r=[],o=null==(t=e.find((e=>e.id===n)))?void 0:t.parentId;for(;o;){const n=e.find((e=>e.id===o));o=null==n?void 0:n.parentId,n&&(r=r.concat(n))}return r}(p.nodesRef.current,r))?void 0:o.some((e=>{var n,t;return null==(n=e.context)||null==(t=n.refs.floating.current)?void 0:t.contains(u)})));c&&i&&!l&&!a&&m.current(!1)}const t=n.floating.current,o=n.reference.current;if(t&&C(o)){let n;return!d&&t.addEventListener("focusout",e),!d&&o.addEventListener("focusout",e),d&&(n=v.current.includes("reference")?i([o,t]):i(t)),()=>{!d&&t.removeEventListener("focusout",e),!d&&o.removeEventListener("focusout",e),null==n||n()}}}),[r,p,d,m,v,g,n]),t.useEffect((()=>{if(a)return;const e=n.floating.current,t=j(k(e));var r;if("number"==typeof s)H(null!=(r=g()[s])?r:e);else if(C(null==s?void 0:s.current)){var o;H(null!=(o=s.current)?o:e)}return()=>{f&&C(t)&&H(t)}}),[a,g,s,f,n]);const b=()=>C(n.reference.current)&&"combobox"===n.reference.current.getAttribute("role")&&B(n.reference.current);return t.createElement(t.Fragment,null,d&&t.createElement(X,{onFocus:e=>{if(b())return;V(e);const n=g();"reference"===c[0]?H(n[0]):H(n[n.length-1])}}),t.cloneElement(u,c.includes("floating")?{tabIndex:0}:{}),d&&l&&t.createElement(X,{onFocus:e=>{b()||(V(e),H(g()[0]))}}))}function q(e){const n=u();return l((()=>{n.current=e}),[e]),n.current}function W(e,n,t){return t&&"mouse"!==t?0:"number"==typeof e?e:null==e?void 0:e[n]}const z=function(e,n){let{enabled:r=!0,delay:o=0,handleClose:u=null,mouseOnly:c=!1,restMs:i=0}=void 0===n?{}:n;const{open:a,onOpenChange:s,dataRef:f,events:d,refs:v}=e,m=y(),p=b(),g=U(s),h=U(u),E=q(a),w=t.useRef(),x=t.useRef(),R=t.useRef(),L=t.useRef(),I=t.useRef(!0),A=t.useRef(!1);t.useEffect((()=>{if(r)return d.on("dismiss",e),()=>{d.off("dismiss",e)};function e(){clearTimeout(x.current),clearTimeout(L.current),I.current=!0}}),[r,d,v]),t.useEffect((()=>{if(!r||!h.current)return;function e(){var e;null!=(e=f.current.openEvent)&&e.type.includes("mouse")&&g.current(!1)}const n=k(v.floating.current).documentElement;return n.addEventListener("mouseleave",e),()=>{n.removeEventListener("mouseleave",e)}}),[v,g,r,h,f]);const O=t.useCallback((function(e){void 0===e&&(e=!0);const n=W(o,"close",w.current);n&&!R.current?(clearTimeout(x.current),x.current=setTimeout((()=>g.current(!1)),n)):e&&g.current(!1)}),[o,g]),M=t.useCallback((()=>{R.current&&(k(v.floating.current).removeEventListener("pointermove",R.current),R.current=void 0)}),[v]),D=t.useCallback((()=>{k(v.floating.current).body.style.pointerEvents="",A.current=!1}),[v]);if(t.useEffect((()=>{if(!r)return;function n(e){if(clearTimeout(x.current),I.current=!1,a||c&&"mouse"!==w.current||i>0&&0===W(o,"open"))return;f.current.openEvent=e;const n=W(o,"open",w.current);n?x.current=setTimeout((()=>{g.current(!0)}),n):g.current(!0)}function t(n){var t,r;if("click"===(null==(t=f.current.openEvent)?void 0:t.type)||"pointerdown"===(null==(r=f.current.openEvent)?void 0:r.type))return;const o=k(v.floating.current);if(clearTimeout(L.current),h.current)return clearTimeout(x.current),R.current&&o.removeEventListener("pointermove",R.current),R.current=h.current({...e,tree:m,x:n.clientX,y:n.clientY,onClose(){M(),O()}}),void o.addEventListener("pointermove",R.current);O()}function u(n){null==h.current||h.current({...e,tree:m,x:n.clientX,y:n.clientY,leave:!0,onClose(){M(),O()}})(n)}const l=v.floating.current,s=v.reference.current;return T(s)?(a&&s.addEventListener("mouseleave",u),null==l||l.addEventListener("mouseleave",u),s.addEventListener("mousemove",n,{once:!0}),s.addEventListener("mouseenter",n),s.addEventListener("mouseleave",t),()=>{a&&s.removeEventListener("mouseleave",u),null==l||l.removeEventListener("mouseleave",u),s.removeEventListener("mousemove",n),s.removeEventListener("mouseenter",n),s.removeEventListener("mouseleave",t)}):void 0}),[r,O,e,o,h,f,c,g,a,m,i,M,v]),l((()=>{if(r&&a&&h.current){k(v.floating.current).body.style.pointerEvents="none",A.current=!0;const t=C(v.reference.current)&&v.reference.current,r=v.floating.current;if(t&&r){var e,n;const o=null==m||null==(e=m.nodesRef.current.find((e=>e.id===p)))||null==(n=e.context)?void 0:n.refs.floating.current;return o&&(o.style.pointerEvents=""),t.style.pointerEvents="auto",r.style.pointerEvents="auto",()=>{t.style.pointerEvents="",r.style.pointerEvents=""}}}}),[r,a,p,v,m,h]),l((()=>{E&&!a&&(w.current=void 0,M(),D())})),t.useEffect((()=>()=>{M(),clearTimeout(x.current),clearTimeout(L.current),A.current&&D()}),[M,D]),!r)return{};function P(e){w.current=e.pointerType}return{reference:{onPointerDown:P,onPointerEnter:P,onMouseMove(){a||0===i||(clearTimeout(L.current),L.current=setTimeout((()=>{I.current||s(!0)}),i))}},floating:{onMouseEnter(){clearTimeout(x.current)},onMouseLeave(){O(!1)}}}},G=t.createContext({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),J=()=>t.useContext(G),Q=e=>{let{children:n,delay:r}=e;const[o,u]=t.useState({delay:r,initialDelay:r,currentId:null}),c=t.useCallback((e=>{u((n=>({...n,currentId:e})))}),[]);return t.createElement(G.Provider,{value:t.useMemo((()=>({...o,setState:u,setCurrentId:c})),[o,u,c])},n)},Z=(e,n)=>{let{open:r,onOpenChange:o}=e,{id:u}=n;const{currentId:c,initialDelay:i,setState:l}=J(),a=U(o);t.useEffect((()=>{c&&a.current&&(l((e=>({...e,delay:{open:1,close:W(i,"close")}}))),c!==u&&a.current(!1))}),[u,a,l,c,i]),t.useEffect((()=>{!r&&c===u&&a.current&&(a.current(!1),l((e=>({...e,delay:i,currentId:null}))))}),[r,l,c,u,a,i])},$=function(e,n){let{open:t}=e,{enabled:r=!0,role:o="dialog"}=void 0===n?{}:n;const u=m(),c=m(),i={id:u,role:o};return r?"tooltip"===o?{reference:{"aria-describedby":t?u:void 0},floating:i}:{reference:{"aria-expanded":t?"true":"false","aria-haspopup":o,"aria-controls":t?u:void 0,..."listbox"===o&&{role:"combobox"},..."menu"===o&&{id:c}},floating:{...i,..."menu"===o&&{"aria-labelledby":c}}}:{}},_=function(e,n){let{open:r,onOpenChange:o,dataRef:u,refs:c}=e,{enabled:i=!0,pointerDown:l=!1,toggle:a=!0,ignoreMouse:s=!1}=void 0===n?{}:n;const f=t.useRef();function d(){return C(c.reference.current)&&"BUTTON"===c.reference.current.tagName}function v(){return B(c.reference.current)}return i?{reference:{onPointerDown(e){if(0===e.button&&(f.current=e.pointerType,("mouse"!==f.current||!s)&&l)){var n;if(r)a&&"pointerdown"===(null==(n=u.current.openEvent)?void 0:n.type)&&o(!1);else o(!0);u.current.openEvent=e.nativeEvent}},onClick(e){if(l&&f.current)f.current=void 0;else if("mouse"!==f.current||!s){var n;if(r)a&&"click"===(null==(n=u.current.openEvent)?void 0:n.type)&&o(!1);else o(!0);u.current.openEvent=e.nativeEvent}},onKeyDown(e){f.current=void 0,d()||(" "!==e.key||v()||e.preventDefault(),"Enter"===e.key&&(r?a&&o(!1):o(!0)))},onKeyUp(e){d()||v()||" "===e.key&&(r?a&&o(!1):o(!0))}}}:{}};function ee(e,n){if(null==n)return!1;if("composedPath"in e)return e.composedPath().includes(n);const t=e;return null!=t.target&&n.contains(t.target)}const ne=function(e,r){let{open:o,onOpenChange:u,refs:c,events:i,nodeId:l}=e,{enabled:a=!0,escapeKey:s=!0,outsidePointerDown:f=!0,referencePointerDown:d=!1,ancestorScroll:v=!1,bubbles:m=!0}=void 0===r?{}:r;const p=y(),g=U(u),b=t.useCallback((()=>{var e;return null==(e=c.floating.current)?void 0:e.contains(j(k(c.floating.current)))}),[c.floating]),h=t.useCallback((()=>{C(c.reference.current)&&c.reference.current.focus()}),[c.reference]);return t.useEffect((()=>{if(!o||!a)return;function e(e){if("Escape"===e.key){if(!m&&!b())return;i.emit("dismiss"),g.current(!1),h()}}function t(e){const n=p&&A(p.nodesRef.current,l).some((n=>{var t;return ee(e,null==(t=n.context)?void 0:t.refs.floating.current)}));ee(e,c.floating.current)||T(c.reference.current)&&ee(e,c.reference.current)||n||(m||b())&&(i.emit("dismiss"),g.current(!1),h())}function r(){g.current(!1)}const u=k(c.floating.current);s&&u.addEventListener("keydown",e),f&&u.addEventListener("mousedown",t);const d=(v?[...T(c.reference.current)?n(c.reference.current):[],...T(c.floating.current)?n(c.floating.current):[]]:[]).filter((e=>{var n;return e!==(null==(n=u.defaultView)?void 0:n.visualViewport)}));return d.forEach((e=>e.addEventListener("scroll",r,{passive:!0}))),()=>{s&&u.removeEventListener("keydown",e),f&&u.removeEventListener("mousedown",t),d.forEach((e=>e.removeEventListener("scroll",r)))}}),[s,f,i,p,l,o,g,h,v,a,m,b,c.floating,c.reference]),a?{reference:{onPointerDown(){d&&(i.emit("dismiss"),u(!1))}}}:{}},te=function(e,n){let{open:r,onOpenChange:o,dataRef:u,refs:c,events:i}=e,{enabled:l=!0,keyboardOnly:a=!0}=void 0===n?{}:n;const s=t.useRef(""),f=t.useRef(!1);return t.useEffect((()=>{var e;if(!l)return;const n=k(c.floating.current),t=null!=(e=n.defaultView)?e:window;function o(){s.current&&c.reference.current===j(n)&&(f.current=!r)}function u(){setTimeout((()=>{f.current=!1,s.current=""}))}return t.addEventListener("focus",u),t.addEventListener("blur",o),()=>{t.removeEventListener("focus",u),t.removeEventListener("blur",o)}}),[c,r,l]),t.useEffect((()=>{if(l)return i.on("dismiss",e),()=>{i.off("dismiss",e)};function e(){f.current=!0}}),[i,l]),l?{reference:{onPointerDown(e){let{pointerType:n}=e;s.current=n,f.current=!(!n||!a)},onFocus(e){var n,t,r;f.current||"focus"===e.type&&"mousedown"===(null==(n=u.current.openEvent)?void 0:n.type)&&T(c.reference.current)&&null!=(t=c.reference.current)&&t.contains(null==(r=u.current.openEvent)?void 0:r.target)||(u.current.openEvent=e.nativeEvent,o(!0))},onBlur(e){var n;const t=e.relatedTarget;null!=(n=c.floating.current)&&n.contains(t)||T(c.reference.current)&&c.reference.current.contains(t)||(f.current=!1,o(!1))}}}:{}};function re(e,n){return n<0||n>=e.current.length}function oe(e,n){let{startingIndex:t=-1,decrement:r=!1,disabledIndices:o}=void 0===n?{}:n;const u=e.current;let c=t;do{var i,l;c+=r?-1:1}while(c>=0&&c<=u.length-1&&(o?o.includes(c):null==u[c]||(null==(i=u[c])?void 0:i.hasAttribute("disabled"))||"true"===(null==(l=u[c])?void 0:l.getAttribute("aria-disabled"))));return c}function ue(e,n,t){switch(e){case"vertical":return n;case"horizontal":return t;default:return n||t}}function ce(e,n){return ue(n,"ArrowUp"===e||"ArrowDown"===e,"ArrowLeft"===e||"ArrowRight"===e)}function ie(e,n,t){return ue(n,"ArrowDown"===e,t?"ArrowLeft"===e:"ArrowRight"===e)||"Enter"===e||" "==e||""===e}function le(e,n){return oe(e,{disabledIndices:n})}function ae(e,n){return oe(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:n})}const se=function(e,n){let{open:r,onOpenChange:o,refs:u}=e,{listRef:c,activeIndex:i,onNavigate:a,enabled:s=!0,selectedIndex:f=null,allowEscape:d=!1,loop:v=!1,nested:m=!1,rtl:p=!1,virtual:g=!1,focusItemOnOpen:h="auto",focusItemOnHover:E=!0,openOnArrowKeyDown:w=!0,disabledIndices:x=(w?void 0:[]),orientation:R="vertical"}=void 0===n?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:n;const L=b(),I=y(),T=q(r),A=t.useRef(h),O=t.useRef(null!=f?f:-1),M=t.useRef(null),D=U(q(a)),P=U(a),S=U(x),F=t.useRef(!1),K=t.useRef(-1),[N,B]=t.useState(),H=t.useCallback(((e,n)=>{K.current=requestAnimationFrame((()=>{var t,r;g?B(null==(t=e.current[n.current])?void 0:t.id):null==(r=e.current[n.current])||r.focus({preventScroll:!0})}))}),[g]);function X(e){if(F.current=!0,m&&function(e,n,t){return ue(n,t?"ArrowRight"===e:"ArrowLeft"===e,"ArrowUp"===e)}(e.key,R,p))return V(e),o(!1),void(C(u.reference.current)&&u.reference.current.focus());const n=O.current,t=le(c,x),i=ae(c,x);if("Home"===e.key&&(O.current=t,a(O.current)),"End"===e.key&&(O.current=i,a(O.current)),ce(e.key,R)){if(V(e),r&&!g&&j(e.currentTarget.ownerDocument)===e.currentTarget)return O.current=ie(e.key,R,p)?t:i,void a(O.current);ie(e.key,R,p)?O.current=v?n>=i?d&&n!==c.current.length?-1:t:oe(c,{startingIndex:n,disabledIndices:x}):Math.min(i,oe(c,{startingIndex:n,disabledIndices:x})):O.current=v?n<=t?d&&-1!==n?c.current.length:i:oe(c,{startingIndex:n,decrement:!0,disabledIndices:x}):Math.max(t,oe(c,{startingIndex:n,decrement:!0,disabledIndices:x})),re(c,O.current)?a(null):a(O.current)}}return l((()=>{s&&(!T&&r&&A.current&&null!=f&&P.current(f),T&&!r&&(cancelAnimationFrame(K.current),O.current=-1,null==D.current||D.current(null)))}),[r,T,f,c,P,D,H,s]),l((()=>{if(s&&r)if(null==i){if(null!=f)return;T&&(O.current=-1,H(c,O)),!T&&A.current&&(null!=M.current||!0===A.current&&null==M.current)&&(O.current=null==M.current||ie(M.current,R,p)||m?le(c,S.current):ae(c,S.current),P.current(O.current),H(c,O))}else re(c,i)||(O.current=i,H(c,O))}),[r,T,i,f,m,c,P,H,s,d,R,p,g,S]),l((()=>{s&&!r&&T&&null!=f&&C(u.reference.current)&&u.reference.current.focus()}),[u.reference,f,r,T,s]),l((()=>{if(s&&!r&&T){var e,n;const t=null==I||null==(e=I.nodesRef.current.find((e=>e.id===L)))||null==(n=e.context)?void 0:n.refs.floating.current;t&&!t.contains(j(k(t)))&&t.focus({preventScroll:!0})}}),[s,r,T,I,L]),l((()=>{M.current=null})),s?{reference:{...g&&r&&null!=i&&{"aria-activedescendant":N},onKeyDown(e){if(F.current=!0,g&&r)return X(e);(0===e.key.indexOf("Arrow")||"Enter"===e.key||" "===e.key||""===e.key)&&(M.current=e.key),m?function(e,n,t){return ue(n,t?"ArrowLeft"===e:"ArrowRight"===e,"ArrowDown"===e)}(e.key,R,p)&&(V(e),r?(O.current=le(c,x),a(O.current)):o(!0)):ce(e.key,R)&&(null!=f&&(O.current=f),V(e),!r&&w?o(!0):X(e),r&&a(O.current))}},floating:{"aria-orientation":"both"===R?void 0:R,...g&&null!=i&&{"aria-activedescendant":N},onKeyDown:X,onPointerMove(){F.current=!1}},item:{onFocus(e){let{currentTarget:n}=e;const t=c.current.indexOf(n);-1!==t&&a(t)},onClick:e=>{let{currentTarget:n}=e;return n.focus({preventScroll:!0})},...E&&{onMouseMove(e){let{currentTarget:n}=e;const t=n;if(t){const e=c.current.indexOf(t);-1!==e&&a(e)}},onMouseLeave(){var e;F.current||(O.current=-1,H(c,O),P.current(null),g||null==(e=u.floating.current)||e.focus({preventScroll:!0}))}}}}:{}},fe=function(e,n){var r;let{open:o,dataRef:u}=e,{listRef:c,activeIndex:i,onMatch:a=(()=>{}),enabled:s=!0,findMatch:f=null,resetMs:d=1e3,ignoreKeys:v=[],selectedIndex:m=null}=void 0===n?{listRef:{current:[]},activeIndex:null}:n;const p=t.useRef(),g=t.useRef(""),b=t.useRef(null!=(r=null!=m?m:i)?r:-1),y=t.useRef(null);function h(e){if(!e.currentTarget.contains(j(k(e.currentTarget))))return;g.current.length>0&&" "!==g.current[0]&&(u.current.typing=!0," "===e.key&&V(e));const n=c.current;if(null==n||["Home","End","Escape","Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight",...v].includes(e.key))return;n.every((e=>{var n,t;return!e||(null==(n=e[0])?void 0:n.toLocaleLowerCase())!==(null==(t=e[1])?void 0:t.toLocaleLowerCase())}))&&g.current===e.key&&(g.current="",b.current=y.current),g.current+=e.key,clearTimeout(p.current),p.current=setTimeout((()=>{g.current="",b.current=y.current,u.current.typing=!1}),d);const t=b.current,r=[...n.slice((null!=t?t:0)+1),...n.slice(0,(null!=t?t:0)+1)],o=f?f(r,g.current):r.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(g.current)))),i=o?n.indexOf(o):-1;-1!==i&&(a(i),y.current=i)}return l((()=>{o&&(clearTimeout(p.current),y.current=null,g.current="")}),[o]),l((()=>{var e;o&&""===g.current&&(b.current=null!=(e=null!=m?m:i)?e:-1)}),[o,m,i]),s?{reference:{onKeyDown:h},floating:{onKeyDown:h}}:{}};export{Q as FloatingDelayGroup,Y as FloatingFocusManager,E as FloatingNode,K as FloatingOverlay,P as FloatingPortal,w as FloatingTree,O as safePolygon,_ as useClick,Z as useDelayGroup,J as useDelayGroupContext,ne as useDismiss,x as useFloating,h as useFloatingNodeId,b as useFloatingParentNodeId,D as useFloatingPortalNode,y as useFloatingTree,te as useFocus,z as useHover,m as useId,L as useInteractions,se as useListNavigation,$ as useRole,fe as useTypeahead};
